<?php
/* Sucuri integrity monitor
 * Integrity checking and server side scanning.
 *
 * Copyright (C) 2010, 2011, 2012 Sucuri, LLC
 * http://sucuri.net
 * Do not distribute or share.
 */

$MYMONITOR = "monitor16";
$my_sucuri_encoding = "



LyogU3VjdXJpIGludGVncml0eSBtb25pdG9yIC4gCiAqIENvbm5lY3RzIGJhY2sgaG9tZS4KICog
Q29weXJpZ2h0IChDKSAyMDEwLTIwMTMgU3VjdXJpLCBMTEMKICogRG8gbm90IGRpc3RyaWJ1dGUg
b3Igc2hhcmUuCiAqLwoKCiRTVUNVUklQV0QgPSAiNTM1ZTI2ZWIwZjMzMjRlODA1NmZlNjk1NDk3
NmIwNGM2MmViOTc3ZjJjYzUxIjsKCgppZihpc3NldCgkX0dFVFsndGVzdCddKSkKewogICAgZWNo
byAiT0s6IFN1Y3VyaTogRm91bmRcbiI7CiAgICBleGl0KDApOwp9CgoKCi8qIFZhbGlkIGFyZ3Vt
ZW50LiAqLwppZighaXNzZXQoJF9HRVRbJ3J1biddKSkKewogICAgZXhpdCgwKTsKfQoKCi8qIE11
c3QgaGF2ZSBhbiBJUCBhZGRyZXNzLiAqLwppZighaXNzZXQoJF9TRVJWRVJbJ1JFTU9URV9BRERS
J10pKQp7CiAgICBleGl0KDApOwp9Cgokb3JpZ3JlbW90ZWlwID0gJF9TRVJWRVJbJ1JFTU9URV9B
RERSJ107CgovKiBJZiBjb21pbmcgZnJvbSBjbG91ZGZsYXJlOiAqLwppZihpc3NldCgkX1NFUlZF
UlsnSFRUUF9DRl9DT05ORUNUSU5HX0lQJ10pKQp7CiAgICAkX1NFUlZFUlsnUkVNT1RFX0FERFIn
XSA9ICRfU0VSVkVSWydIVFRQX0NGX0NPTk5FQ1RJTkdfSVAnXTsKfQovKiBNb3JlIGdhdGV3YXkg
cmVxdWVzdHMuICovCmVsc2UgaWYoaXNzZXQoJF9TRVJWRVJbJ0hUVFBfWF9PUklHX0NMSUVOVF9J
UCddKSkKewogICAgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gPSAkX1NFUlZFUlsnSFRUUF9YX09S
SUdfQ0xJRU5UX0lQJ107Cn0KLyogUHJveHkgcmVxdWVzdHMuICovCmVsc2UgaWYoaXNzZXQoJF9T
RVJWRVJbJ0hUVFBfVFJVRV9DTElFTlRfSVAnXSkpCnsKICAgICRfU0VSVkVSWydSRU1PVEVfQURE
UiddID0gJF9TRVJWRVJbJ0hUVFBfVFJVRV9DTElFTlRfSVAnXTsKfQovKiBQcm94eSByZXF1ZXN0
cy4gKi8KZWxzZSBpZihpc3NldCgkX1NFUlZFUlsnSFRUUF9YX1JFQUxfSVAnXSkpCnsKICAgICRf
U0VSVkVSWydSRU1PVEVfQUREUiddID0gJF9TRVJWRVJbJ0hUVFBfWF9SRUFMX0lQJ107Cn0KLyog
TW9yZSBnYXRld2F5IHJlcXVlc3RzLiAqLwplbHNlIGlmKGlzc2V0KCRfU0VSVkVSWydIVFRQX1hf
Rk9SV0FSREVEX0ZPUiddKSkKewogICAgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gPSAkX1NFUlZF
UlsnSFRUUF9YX0ZPUldBUkRFRF9GT1InXTsKfQoKCiRteWlwbGlzdCA9IGFycmF5KAonOTcuNzQu
MTI3LjE3MScsCic2OS4xNjQuMjAzLjE3MicsCicxNzMuMjMwLjEyOC4xMzUnLAonNjYuMjI4LjM0
LjQ5JywKJzY2LjIyOC40MC4xODUnLAonNTAuMTE2LjMuMTcxJywKJzUwLjExNi4zNi45MicsCicx
OTguNTguOTYuMjEyJywKJzUwLjExNi42My4yMjEnLAonMTkyLjE1NS45Mi4xMTInLAonMTkyLjgx
LjEyOC4zMScsCicxOTguNTguMTA2LjI0NCcsCicyNjAwOjNjMDA6OmYwM2M6OTFmZjpmZWFlOmUx
MDQnLAonMjYwMDozYzAyOjpmMDNjOjkxZmY6ZmVkZjo1OGM2JywKJzI2MDA6M2MwMjo6ZjAzYzo5
MWZmOmZlZGY6NTgzNScsCicyNjAwOjNjMDM6OmYwM2M6OTFmZjpmZWRmOjZhN2EnLAonZmU4MDo6
ZmNmZDphZGZmOmZlZTY6ODA4NycsCicyNjAwOjNjMDM6OmYwM2M6OTFmZjpmZTcwOjM2Y2UnLAon
MjYwMDozYzAyOjpmMDNjOjkxZmY6ZmU3MDpmMTJkJywKJzI2MDA6M2MwMTo6ZjAzYzo5MWZmOmZl
NzA6NTJiYicsCic1MC4xMTYuMzYuOTMnLAoiMTkyLjE1NS45NS4xMzkiLAoiMjYwMDozYzAyOjpm
MDNjOjkxZmY6ZmU2OTo0YjY2IiwKIjI2MDA6M2MwMDo6ZjAzYzo5MWZmOmZlNzA6NTIxMyIsCiIy
NjAwOjNjMDM6OmYwM2M6OTFmZjpmZWRiOmI5Y2UiLAoiMjMuMjM5LjkuMjI3IiwKIjE5OC41OC4x
MTIuMTAzIiwKIjE5Mi4xNTUuOTQuNDMiLAoiMTYyLjIxNi4xNi4zMyIsCiIyNjAwOjNjMDA6OmYw
M2M6OTFmZjpmZTZlOmEwNDYiLAoiMjYwMDozYzAyOjpmMDNjOjkxZmY6ZmU2ZTphMGRkIiwKIjI2
MDA6M2MwMzo6ZjAzYzo5MWZmOmZlNmU6YTBhYyIsCik7CgoKJGlwbWF0Y2hlcyA9IDA7Cgpmb3Jl
YWNoKCRteWlwbGlzdCBhcyAkbXlpcCkKewogICAgaWYoc3RycG9zKCRfU0VSVkVSWydSRU1PVEVf
QUREUiddLCAkbXlpcCkgIT09IEZBTFNFKQogICAgewogICAgICAgICRpcG1hdGNoZXMgPSAxOwog
ICAgICAgIGJyZWFrOwogICAgfQogICAgaWYoc3RycG9zKCRvcmlncmVtb3RlaXAsICRteWlwKSAh
PT0gRkFMU0UpCiAgICB7CiAgICAgICAgJGlwbWF0Y2hlcyA9IDE7CiAgICAgICAgYnJlYWs7CiAg
ICB9Cn0KCgppZigkaXBtYXRjaGVzID09IDApCnsKICAgIGVjaG8gIkVSUk9SOiBJbnZhbGlkIElQ
IEFkZHJlc3NcbiI7CiAgICBleGl0KDApOwp9CgoKLyogVmFsaWQga2V5LiAqLwppZighaXNzZXQo
JF9QT1NUWydzc2NyZWQnXSkpCnsKICAgIGVjaG8gIkVSUk9SOiBJbnZhbGlkIGFyZ3VtZW50XG4i
OwogICAgZXhpdCgwKTsKfQoKCi8qIENvbm5lY3QgYmFjayB0byBnZXQgd2hhdCB0byBydW4uICov
CmlmKCFmdW5jdGlvbl9leGlzdHMoJ2N1cmxfZXhlYycpIHx8IGlzc2V0KCRfR0VUWydub2N1cmwn
XSkpCnsKICAgICRwb3N0ZGF0YSA9IGh0dHBfYnVpbGRfcXVlcnkoCiAgICAgICAgICAgIGFycmF5
KAogICAgICAgICAgICAgICAgJ3AnID0+ICRTVUNVUklQV0QsCiAgICAgICAgICAgICAgICAncScg
PT4gJF9QT1NUWydzc2NyZWQnXSwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKTsKCiAg
ICAkb3B0cyA9IGFycmF5KCdodHRwJyA9PgogICAgICAgICAgICBhcnJheSgKICAgICAgICAgICAg
ICAgICdtZXRob2QnICA9PiAnUE9TVCcsCiAgICAgICAgICAgICAgICAnaGVhZGVyJyAgPT4gJ0Nv
bnRlbnQtdHlwZTogYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywKICAgICAgICAg
ICAgICAgICdjb250ZW50JyA9PiAkcG9zdGRhdGEKICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgKTsKCiAgICAkY29udGV4dCA9IHN0cmVhbV9jb250ZXh0X2NyZWF0ZSgkb3B0cyk7CiAgICAk
bXlfc3VjdXJpX2VuY29kaW5nID0gZmlsZV9nZXRfY29udGVudHMoImh0dHBzOi8vJE1ZTU9OSVRP
Ui5zdWN1cmkubmV0L2ltb25pdG9yIiwgZmFsc2UsICRjb250ZXh0KTsKCiAgICBpZihzdHJuY21w
KCRteV9zdWN1cmlfZW5jb2RpbmcsICJXT1JLRUQ6Iiw3KSA9PSAwKQogICAgewogICAgfQogICAg
ZWxzZQogICAgewogICAgICAgIGVjaG8gIkVSUk9SOiBVbmFibGUgdG8gY29tcGxldGUgKG1pc3Np
bmcgY3VybCBzdXBwb3J0IGFuZCBmaWxlX2dldCBmYWlsZWQpLiBQbGVhc2UgY29udGFjdCBzdXBw
b3J0QHN1Y3VyaS5uZXQgZm9yIGd1aWRhbmNlLlxuIjsKICAgICAgICBleGl0KDEpOwogICAgfQp9
CgplbHNlCnsKCiAgICAkY2ggPSBjdXJsX2luaXQoKTsKICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VS
TE9QVF9VUkwsICJodHRwczovLyRNWU1PTklUT1Iuc3VjdXJpLm5ldC9pbW9uaXRvciIpOwogICAg
Y3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsKICAgIGN1cmxf
c2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsKICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VS
TE9QVF9QT1NURklFTERTLCAicD0kU1VDVVJJUFdEJnE9Ii4kX1BPU1RbJ3NzY3JlZCddKTsgCiAg
ICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIGZhbHNlKTsKCiAgICAk
bXlfc3VjdXJpX2VuY29kaW5nID0gY3VybF9leGVjKCRjaCk7CiAgICBjdXJsX2Nsb3NlKCRjaCk7
CgogICAgaWYoc3RybmNtcCgkbXlfc3VjdXJpX2VuY29kaW5nLCAiV09SS0VEOiIsNykgPT0gMCkK
ICAgIHsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBpZigkbXlfc3VjdXJpX2VuY29kaW5n
ID09IE5VTEwgfHwgc3RybGVuKCRteV9zdWN1cmlfZW5jb2RpbmcpIDwgMykKICAgICAgICB7CiAg
ICAgICAgICAgICRteV9zdWN1cmlfZW5jb2RpbmcgPSAieDIzNTEiOwogICAgICAgIH0KICAgICAg
ICBlY2hvICJFUlJPUjogVW5hYmxlIHRvIGNvbm5lY3QgYmFjayB0byBTdWN1cmkgKGVycm9yOiAk
bXlfc3VjdXJpX2VuY29kaW5nKS4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydEBzdWN1cmkubmV0IGZv
ciBndWlkYW5jZS5cbiI7CiAgICAgICAgZXhpdCgxKTsKICAgIH0KfQoKCiRteV9zdWN1cmlfZW5j
b2RpbmcgPSAgYmFzZTY0X2RlY29kZSgKICAgICAgICAgICAgICAgICAgICAgICBzdWJzdHIoJG15
X3N1Y3VyaV9lbmNvZGluZywgNykpOwoKCmV2YWwoCiAgICAkbXlfc3VjdXJpX2VuY29kaW5nCiAg
ICApOwoKCg==

";

/* Encoded to avoid that it gets flagged by AV products or even ourselves :) */
eval
    (base64_decode(
                    $my_sucuri_encoding));
exit(0); ?>    
    
